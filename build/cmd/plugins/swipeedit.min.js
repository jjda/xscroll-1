define(function(e,t,l){var n,i=e("../util"),r=e("../base"),o=i.prefixStyle("transform"),s=i.prefixStyle("transition"),a="xs-plugin-swipeedit-",c=!1,d=20,f=!1,u=!1,g=i.vendor?["-",i.vendor,"-transform"].join(""):"transform",h=1,p=function(e){p.superclass.constructor.call(this),this.userConfig=i.mix({labelSelector:a+"label",renderHook:function(e){e.innerHTML=tpl}},e)};if(i.extend(p,r,{pluginId:"swipeedit",pluginInitializer:function(e){var t=this;t.xscroll=e,t.xscroll.on("aftereventbind",function(){t._bindEvt()})},pluginDestructor:function(){},getTransformX:function(e){if(!e)return"";var t=getComputedStyle(e)[o].match(/[-\d\.*\d*]+/g);return t?t[4]/1:0},_bindEvt:function(){var e=this,t=e.xscroll,l=e.xscroll.mc,i=null;l.on("panstart",function(t){u=!1,t.cell&&t.cell.element&&(i=t.cell.element.querySelector(e.userConfig.labelSelector),i&&(n=e.getTransformX(i),i.style[s]="none",Math.abs(n)>0&&!f&&e.slideRight(t)))}),l.on("pan",function(l){if(i)if("left"==l.touch.directionX&&e.slideAllExceptRow(l.cell._row),Math.abs(l.deltaY)<10&&Math.abs(l.deltaX)/Math.abs(l.deltaY)>4&&Math.abs(l.deltaX)>d){c=!0,t.userConfig.lockY=!0;var r=n+l.deltaX+d;if(r>0)return;i.style[s]="none",i.style[o]="translateX("+r+"px)"}else c||(t.userConfig.lockY=!1)}),l.on("panend",function(t){if(i){c=!1;var l=e.getTransformX(i);"left"==t.touch.directionX&&Math.abs(t.velocityX)>h?e.slideLeftHandler(t):Math.abs(l)<e.userConfig.width/2?e.slideRightHandler(t):Math.abs(l)>=e.userConfig.width/2&&e.slideLeftHandler(t)}}),document.body.addEventListener("webkitTransitionEnd",function(t){new RegExp(e.userConfig.labelSelector.replace(/\./,"")).test(t.target.className)&&(f=!1)})},slideLeft:function(e){var t=this,l=t.xscroll,n=l.getCellByRowOrCol(e);if(n&&n.element){var i=n.element.querySelector(t.userConfig.labelSelector);i&&i.style&&(i.style[o]="translateX(-"+t.userConfig.width+"px) ",i.style[s]=g+" 0.15s ease",l.getData(0,e).data.status="delete")}},slideRight:function(e){var t=this,l=t.xscroll,n=l.getCellByRowOrCol(e);if(n&&n.element){var i=n.element.querySelector(t.userConfig.labelSelector);if(i&&i.style){var r=window.getComputedStyle(i)[o].match(/[-\d\.*\d*]+/g),a=r?Math.round(r[4]):0;0!=a&&(i.style[o]="translateX(0)",i.style[s]=g+" 0.5s ease",l.getData(0,e).data.status="")}}},slideLeftHandler:function(e){var t=this;f=!0,t.slideLeft(e.cell._row)},slideRightHandler:function(e){var t=this;u=!0,f=!0,t.slideRight(e.cell._row)},slideAllExceptRow:function(e){var t=this,l=t.xscroll;for(var n in l.infiniteElementsCache)(e!=l.infiniteElementsCache[n]._row||void 0===e)&&t.slideRight(l.infiniteElementsCache[n]._row)}}),"object"==typeof l&&l.exports)l.exports=p;else if(window.XScroll&&window.XScroll.Plugins)return XScroll.Plugins.SwipeEdit=p});
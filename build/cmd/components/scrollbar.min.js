define(function(r,t,o){var i=r("../util"),e=r("../animate"),s=60,l=8,n=i.prefixStyle("transform"),a=i.vendor?["-",i.vendor,"-transform"].join(""):"transform",c=i.prefixStyle("transition"),d=(i.prefixStyle("borderRadius"),i.prefixStyle("transitionDuration"),function(r){this.userConfig=r,this.init(r.xscroll)});return i.mix(d.prototype,{init:function(r){var t=this;t.xscroll=r,t.type=t.userConfig.type,t.isY="y"==t.type?!0:!1,t.scrollTopOrLeft=t.isY?"scrollTop":"scrollLeft";var o=t.xscroll.boundry;t.containerSize=t.isY?t.xscroll.containerHeight+o._xtop+o._xbottom:t.xscroll.containerWidth+o._xright+o._xleft,t.indicateSize=t.isY?t.xscroll.height:t.xscroll.width,t.pos=t.isY?r.getScrollTop():r.getScrollLeft(),t.render(),t._bindEvt()},destroy:function(){var r=this;r.scrollbar&&r.scrollbar.remove(),r.xscroll.off("scroll",r._scrollHandler,r),r.xscroll.off("scrollend",r._scrollEndHandler,r),delete r},render:function(){var r=this;if(!r.__isRender){r.__isRender=!0;var t=r.xscroll,o=t.userConfig.gpuAcceleration?" translateZ(0) ":"",i=o?a+":"+o+";":"",e="opacity:0;position:absolute;z-index:999;overflow:hidden;-webkit-border-radius:3px;-moz-border-radius:3px;-o-border-radius:3px;"+i,s=r.isY?"width: 3px;bottom:5px;top:5px;right:3px;"+e:"height:3px;left:5px;right:5px;bottom:3px;"+e;r.scrollbar=document.createElement("div"),r.scrollbar.style.cssText=s,t.renderTo.appendChild(r.scrollbar);var l=r.isY?"width:100%;":"height:100%;";r.indicate=document.createElement("div"),r.indicate.style.cssText=l+"position:absolute;background:rgba(0,0,0,0.3);-webkit-border-radius:3px;-moz-border-radius:3px;-o-border-radius:3px;",r.scrollbar.appendChild(r.indicate),r._update(),r.hide(0)}},_update:function(r,t,o,i){var e=this,r=void 0===r?e.isY?e.xscroll.getScrollTop():e.xscroll.getScrollLeft():r,s=e.computeScrollBar(r),l=e.isY?"height":"width";e.indicate.style[l]=Math.round(s.size)+"px",t&&o?e.scrollTo(s.pos,t,o,i):e.moveTo(s.pos)},computeScrollBar:function(r){var t=this,r=(t.isY?"y":"x",Math.round(r)),o=10,i=t.xscroll.boundry;t.containerSize=t.isY?t.xscroll.containerHeight+i._xtop+i._xbottom:t.xscroll.containerWidth+i._xright+i._xleft,t.size=t.isY?t.xscroll.height:t.xscroll.width,t.indicateSize=t.isY?t.xscroll.height-o:t.xscroll.width-o;var e=t.indicateSize,n=t.containerSize,a=n-t.size,c=r/n,d=e*c,u=Math.round(e*t.size/n),p=d*(e-s+u)/e;if(s>u&&(u=s,d=p),0>d)d=Math.abs(r)*u/s>u-l?l-u:r*u/s;else if(d+u>e&&r-a>0){var x=r-n+e;d=x*u/s>u-l?e+o-l:e+o-u+x*u/s}return t.barpos=Math.round(d),result={size:Math.round(u),pos:t.barpos}},scrollTo:function(r,t,o,i){var s=this;s.show();var l=s.xscroll.userConfig.gpuAcceleration?" translateZ(0) ":"",n={css:{transform:s.isY?"translateY("+r+"px)"+l:"translateX("+r+"px)"+l},duration:t,easing:o,useTransition:s.xscroll.userConfig.useTransition,end:i};s.__timer=s.__timer||new e(s.indicate,n),s.__timer.stop(),s.__timer.reset(n),s.__timer.run()},moveTo:function(r){var t=this;t.show();var o=t.xscroll.userConfig.gpuAcceleration?" translateZ(0) ":"";t.indicate.style[n]=t.isY?"translateY("+r+"px) "+o:"translateX("+r+"px) "+o,t.indicate.style[c]=""},_scrollHandler:function(r){var t=this;return t._update(r[t.scrollTopOrLeft]),t},isBoundryOut:function(){var r=this;return r.isY?r.xscroll.isBoundryOutTop()||r.xscroll.isBoundryOutBottom():r.xscroll.isBoundryOutLeft()||r.xscroll.isBoundryOutRight()},_scrollEndHandler:function(r){var t=this;return t.isBoundryOut()||(t._update(r[t.scrollTopOrLeft]),t.hide()),t},_bindEvt:function(){var r=this;r.__isEvtBind||(r.__isEvtBind=!0,r.xscroll.on("scroll",r._scrollHandler,r),r.xscroll.on("scrollend",r._scrollEndHandler,r))},reset:function(){var r=this;r.pos=0,r._update()},hide:function(r,t,o){var i=this,r=r>=0?r:300,o=o>=0?o:100;i.scrollbar.style.opacity=0,i.scrollbar.style[c]=["opacity ",r,"ms "," ease-out ",o,"ms"].join("")},show:function(){var r=this;r.scrollbar.style.opacity=1,r.scrollbar.style[c]=""}}),"object"==typeof o&&o.exports?void(o.exports=d):d});